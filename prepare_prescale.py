import pickle
import os
pfile=os.environ["afs_dir"]+"/samples_orig.pkl"

sample_dic = pickle.load(open(pfile,'rb'))
year = 2016
#year = 2017
#year = 2018
stype = "data"
sname = "SinglePhoton"
if year == 2016:
	#sname = "SingleMuon"
	target_filename_dict={"HLT_Photon36_2016.sh":("HLT_Photon36_R9Id90_HE10_IsoM_prescale1_2016_36p12.json","HLT_Photon36_R9Id90_HE10_IsoM_prescale2_2016_0p40.json","HLT_Photon36_R9Id90_HE10_IsoM_prescale25_2016_0p04.json"),\
"HLT_Photon50_2016.sh":("HLT_Photon50_R9Id90_HE10_IsoM_prescale1_2016_2p20.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale10_2016_0p04.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale104_2016_2p70.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale120_2016_1p47.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale125_2016_0p00.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale13_2016_0p00.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale130_2016_2p16.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale150_2016_3p21.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale160_2016_0p12.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale170_2016_2p13.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale189_2016_1p81.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale20_2016_0p60.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale209_2016_0p20.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale26_2016_0p01.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale3_2016_0p00.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale30_2016_1p13.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale46_2016_0p22.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale48_2016_5p47.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale5_2016_0p00.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale60_2016_5p79.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale65_2016_1p98.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale7_2016_0p00.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale80_2016_3p04.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale9_2016_0p01.json", "HLT_Photon50_R9Id90_HE10_IsoM_prescale91_2016_4p41.json"),\
"HLT_Photon75_2016.sh":("HLT_Photon75_R9Id90_HE10_IsoM_prescale1_2016_2p20.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale12_2016_6p43.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale13_2016_1p98.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale16_2016_3p04.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale18_2016_4p41.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale2_2016_0p05.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale21_2016_2p70.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale24_2016_1p48.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale26_2016_2p16.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale3_2016_0p00.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale30_2016_3p21.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale32_2016_0p12.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale34_2016_2p13.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale38_2016_1p81.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale4_2016_0p60.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale42_2016_0p20.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale5_2016_0p01.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale6_2016_1p13.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale8_2016_4p83.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale9_2016_0p22.json"),\
"HLT_Photon90_2016.sh":("HLT_Photon90_R9Id90_HE10_IsoM_prescale1_2016_2p21.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale10_2016_2p70.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale12_2016_1p48.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale13_2016_2p16.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale15_2016_3p21.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale16_2016_0p12.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale17_2016_2p13.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale19_2016_1p81.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale2_2016_0p60.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale21_2016_0p20.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale3_2016_1p14.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale4_2016_5p47.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale5_2016_0p22.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale6_2016_5p79.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale7_2016_1p98.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale8_2016_3p04.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale9_2016_4p41.json"),\
"HLT_Photon120_2016.sh":("HLT_Photon120_R9Id90_HE10_IsoM_prescale1_2016_3p42.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale2_2016_16p28.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale3_2016_7p10.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale4_2016_3p64.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale5_2016_3p21.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale6_2016_3p95.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale7_2016_0p20.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale8_2016_0p12.json"),\
"HLT_Photon165_2016.sh":("HLT_Photon165_R9Id90_HE10_IsoM_prescale1_2016_36p52.json",)\
#"HLT_Photon175_2016.sh":("HLT_Photon175_prescale1_2016_36p52.json",)\
}
elif year == 2017:
	#sname = "SingleMuon_UL"
	target_filename_dict={"HLT_Photon50_2017.sh":("HLT_Photon50_R9Id90_HE10_IsoM_prescale0_2017_0p00.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale1_2017_0p07.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale122_2017_5p47.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale129_2017_0p95.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale163_2017_6p50.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale172_2017_1p19.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale196_2017_1p63.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale198_2017_0p52.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale207_2017_0p46.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale224_2017_0p46.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale228_2017_0p91.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale240_2017_2p65.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale241_2017_0p61.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale251_2017_0p03.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale259_2017_2p83.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale261_2017_0p75.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale270_2017_0p13.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale294_2017_2p19.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale300_2017_0p01.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale326_2017_2p70.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale41_2017_0p25.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale43_2017_0p16.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale82_2017_2p41.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale86_2017_0p54.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale90_2017_8p12.json"),\
"HLT_Photon75_2017.sh":("HLT_Photon75_R9Id90_HE10_IsoM_prescale0_2017_0p00.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale1_2017_0p07.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale10_2017_0p42.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale18_2017_8p12.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale20_2017_2p41.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale21_2017_0p54.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale30_2017_5p47.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale31_2017_0p95.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale40_2017_6p50.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale41_2017_1p19.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale47_2017_2p15.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale48_2017_2p65.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale49_2017_0p46.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale53_2017_0p46.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale54_2017_0p13.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale55_2017_0p91.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale57_2017_0p61.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale60_2017_0p01.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale62_2017_2p83.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale63_2017_0p75.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale64_2017_0p03.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale71_2017_2p19.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale79_2017_2p70.json"),\
"HLT_Photon90_2017.sh":("HLT_Photon90_R9Id90_HE10_IsoM_prescale0_2017_0p00.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale1_2017_0p07.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale10_2017_2p95.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale15_2017_6p42.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale20_2017_6p50.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale21_2017_1p19.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale24_2017_4p80.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale25_2017_0p46.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale27_2017_0p59.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale28_2017_0p91.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale29_2017_0p61.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale30_2017_0p04.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale31_2017_2p83.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale32_2017_0p75.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale36_2017_2p19.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale40_2017_2p70.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale5_2017_0p42.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale9_2017_8p12.json"),\
"HLT_Photon120_2017.sh":("HLT_Photon120_R9Id90_HE10_IsoM_prescale0_2017_0p00.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale1_2017_0p07.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale10_2017_4p19.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale11_2017_0p01.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale12_2017_2p20.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale13_2017_2p70.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale14_2017_0p03.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale2_2017_0p42.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale3_2017_10p20.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale4_2017_0p86.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale5_2017_4p99.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale6_2017_1p43.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale7_2017_6p60.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale8_2017_6p35.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale9_2017_1p49.json"),\
"HLT_Photon165_2017.sh":("HLT_Photon165_R9Id90_HE10_IsoM_prescale0_2017_0p00.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale1_2017_18p58.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale2_2017_15p54.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale3_2017_1p79.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale4_2017_5p62.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale5_2017_0p01.json"),\
"HLT_Photon200_2017.sh":("HLT_Photon200_prescale0_2017_0p00.json","HLT_Photon200_prescale1_2017_41p54.json")}
elif year == 2018:
	#sname = "SingleMuon_UL"		
	target_filename_dict={"HLT_Photon50_2018.sh":("HLT_Photon50_R9Id90_HE10_IsoM_prescale0_2018_0p00.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale1_2018_0p01.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale129_2018_0p44.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale172_2018_0p65.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale224_2018_0p30.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale256_2018_51p91.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale259_2018_3p89.json","HLT_Photon50_R9Id90_HE10_IsoM_prescale86_2018_0p02.json"),\
"HLT_Photon75_2018.sh":("HLT_Photon75_R9Id90_HE10_IsoM_prescale0_2018_0p00.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale1_2018_0p01.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale21_2018_0p02.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale31_2018_0p44.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale41_2018_0p65.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale53_2018_0p30.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale62_2018_3p89.json","HLT_Photon75_R9Id90_HE10_IsoM_prescale64_2018_51p91.json"),\
"HLT_Photon90_2018.sh":("HLT_Photon90_R9Id90_HE10_IsoM_prescale0_2018_0p00.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale1_2018_0p01.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale10_2018_0p02.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale15_2018_0p44.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale21_2018_0p65.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale27_2018_0p30.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale31_2018_3p89.json","HLT_Photon90_R9Id90_HE10_IsoM_prescale32_2018_51p91.json"),\
"HLT_Photon120_2018.sh":("HLT_Photon120_R9Id90_HE10_IsoM_prescale0_2018_0p00.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale1_2018_0p01.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale10_2018_3p89.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale3_2018_0p02.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale5_2018_0p44.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale7_2018_0p65.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale8_2018_51p91.json","HLT_Photon120_R9Id90_HE10_IsoM_prescale9_2018_0p30.json"),\
"HLT_Photon165_2018.sh":("HLT_Photon165_R9Id90_HE10_IsoM_prescale0_2018_0p00.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale1_2018_9p87.json","HLT_Photon165_R9Id90_HE10_IsoM_prescale4_2018_47p35.json"),\
"HLT_Photon200_2018.sh":("HLT_Photon200_prescale0_2018_0p00.json","HLT_Photon200_prescale1_2018_57p22.json")}

sdict = sample_dic[year][stype][sname]
targetdir_suffix = "Low_PT"
ndiv=20
for target_filename in  target_filename_dict.keys():
	writing_file = open(target_filename, "a")
	print(target_filename)
	for trigger in target_filename_dict[target_filename]:
		for ci,bin_name in enumerate(sdict.keys()):
			cur_dir = sdict[bin_name]["dir"]
			flist = os.listdir(cur_dir)
			print(bin_name)
			if not os.path.exists(os.environ["cern_box"]+"/data/"+str(year)+"/"+sname+"/"+targetdir_suffix+"/"+sdict[bin_name]["dir"].split("/")[-1]+"/"):
				os.makedirs(os.environ["cern_box"]+"/data/"+str(year)+"/"+sname+"/"+targetdir_suffix+"/"+sdict[bin_name]["dir"].split("/")[-1]+"/")
			for f in flist:
				print(f)
				for indiv in range(ndiv):
					new_line="python "+os.environ["afs_dir"]+"analyse_trigger.py --year="+str(year)+" --sname="+sname+" --stype="+stype+" --letter="+bin_name+" --ndiv="+str(ndiv)+" --divIndex="+str(indiv)+" --trigname="+trigger+" --filename="+f+"\n"
					writing_file.write(new_line)
        writing_file.close()
